# 学习记账本（云开发版本）

一个基于**微信云开发**的学习记账小程序，数据保存在云端，支持跨设备同步。

---

## ✨ 功能特性

### 📝 快速记录
- 支持输赢金额的快速录入
- 可添加备注信息（场次类型、对手等）
- 自定义记录日期

### 📊 实时统计
- 本月战况实时显示
- 按月统计：查看每月的输赢情况、胜率分析
- 按年统计：查看全年的战况总结

### ☁️ 云端存储
- **数据保存在微信云端**，换手机也能看到
- **每个用户独立数据**，自动根据微信账号隔离
- **跨设备同步**，登录即可查看自己的数据
- **永久保存**，不会因为卸载小程序而丢失

### 🎨 数据可视化
- 清晰的卡片式设计
- 红绿配色直观展示盈亏
- 胜率计算自动展示

---

## 🚀 快速开始

### 1. 开通云开发

**详细配置教程请查看：[CLOUD_SETUP.md](./CLOUD_SETUP.md)**

简要步骤：
1. 在微信开发者工具中打开项目
2. 点击顶部菜单栏"云开发"
3. 同意协议并开通云开发
4. 创建云环境并记下环境 ID

### 2. 创建数据库集合

1. 打开云开发控制台 → 数据库
2. 创建集合：`poker_records`
3. 设置权限：**仅创建者可读写**

### 3. 编译运行

1. 点击"编译"按钮
2. 查看控制台是否输出："云开发环境初始化成功"
3. 开始使用！

---

## 📁 项目结构

```
poker-ledger/
├── pages/
│   ├── index/           # 首页（记录列表 + 本月统计）
│   ├── add/             # 添加记录页面
│   └── statistics/      # 统计页面（按月/按年）
├── utils/
│   └── util.js          # 工具函数（日期格式化、统计计算等）
├── app.js               # 小程序入口（云开发初始化）
├── app.json             # 小程序配置
├── app.wxss             # 全局样式
├── project.config.json  # 项目配置（包含云开发配置）
├── README.md            # 项目说明
└── CLOUD_SETUP.md       # 云开发配置教程
```

---

## 🗄️ 数据库设计

### 集合：`poker_records`

| 字段 | 类型 | 说明 |
|------|------|------|
| `_id` | String | 自动生成的唯一 ID |
| `_openid` | String | 用户的 openid（自动添加，用于数据隔离） |
| `amount` | Number | 输赢金额（正数为赢，负数为输） |
| `note` | String | 备注信息 |
| `date` | String | 日期（格式：YYYY-MM-DD） |
| `createTime` | Number | 创建时间戳 |

---

## 🔒 数据安全

### 权限控制
- 使用"仅创建者可读写"权限模式
- 用户只能读写自己创建的数据
- 自动根据 `_openid` 进行数据隔离
- 无需额外编写权限控制代码

### 数据备份
- 微信云端自动备份
- 可以在云开发控制台导出数据（CSV/JSON）

---

## 💰 费用说明

### 免费额度（每月）

| 资源 | 免费额度 |
|------|----------|
| 数据库读操作 | 5万次 |
| 数据库写操作 | 3万次 |
| 数据库存储 | 2GB |
| 云函数调用 | 10万次 |

> 个人记账小程序，免费额度完全够用，无需担心费用。

---

## 📝 使用说明

### 添加记录
1. 点击首页的"添加记录"按钮
2. 选择"赢"或"输"
3. 输入金额（只输入数字，符号会自动添加）
4. 可选：添加备注（如"线下局"、"好友局"等）
5. 选择日期（默认为当天）
6. 点击"保存记录"

### 查看统计
- **首页**：查看本月总战况和最近20条记录
- **统计页面**：
  - 按月统计：查看每个月的详细数据
  - 按年统计：查看每年的总体情况
  - 包含总金额、次数、胜率等指标

---

## 🆚 版本对比

| 功能 | 本地存储版本 | 云开发版本 ✅ |
|------|-------------|--------------|
| 数据存储位置 | 手机本地 | 微信云端 |
| 换手机后 | 数据丢失 ❌ | 数据同步 ✅ |
| 卸载小程序后 | 数据丢失 ❌ | 数据保留 ✅ |
| 用户隔离 | 无账号系统 | 自动隔离 ✅ |
| 数据备份 | 需手动 | 自动备份 ✅ |
| 配置复杂度 | 简单 | 需配置云开发 |

---

## 🛠️ 技术栈

- 微信小程序原生开发
- JavaScript ES6+
- WXML + WXSS
- **微信云开发**
  - 云数据库（存储数据）
  - 云函数（可选，暂未使用）

---

## ❓ 常见问题

### 1. 如何切换不同的微信账号使用？
- 直接切换微信登录即可
- 每个微信账号的数据自动隔离

### 2. 数据会丢失吗？
- 不会，数据保存在微信云端
- 即使换手机、卸载小程序，重新登录后数据依然存在

### 3. 可以导出数据吗？
- 可以，在云开发控制台导出（CSV/JSON）
- 详见 [CLOUD_SETUP.md](./CLOUD_SETUP.md#5-如何导出数据)

### 4. 免费额度够用吗？
- 够用，个人使用完全在免费额度内
- 每月 5万次读操作、3万次写操作

### 5. 如何清空所有数据？
- 在云开发控制台手动删除
- 详见 [CLOUD_SETUP.md](./CLOUD_SETUP.md#6-如何清空数据)

---

## 📞 获取帮助

- **云开发配置教程**：[CLOUD_SETUP.md](./CLOUD_SETUP.md)
- **微信开放社区**：https://developers.weixin.qq.com/community/
- **云开发文档**：https://developers.weixin.qq.com/miniprogram/dev/wxcloud/basis/getting-started.html

---

## 🎉 后续优化计划

- [ ] 添加记录删除功能
- [ ] 添加记录编辑功能
- [ ] 数据导出功能（小程序内）
- [ ] 更多统计图表（折线图、饼图等）
- [ ] 多账本支持（线上/线下分开记录）
- [ ] 云函数优化查询性能

---

## 👨‍💻 开发者

- 用户：zhaolong
- 创建时间：2026年2月
- 版本：2.0.0（云开发版本）

---

## 📄 许可证

MIT License

---

祝你学习常胜！🎰✨
